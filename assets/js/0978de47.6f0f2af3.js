"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[61],{7625:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>a});var s=r(4848),t=r(8453);const d={sidebar_position:4},c="4. Data Enrichment",i={id:"data-processing/data-enrichment",title:"4. Data Enrichment",description:"## 4.1 Extract and enrich region (country/ country: city) and geographical location (lat, lon) information",source:"@site/docs/data-processing/data-enrichment.mdx",sourceDirName:"data-processing",slug:"/data-processing/data-enrichment",permalink:"/tracy-sra-doc/docs/data-processing/data-enrichment",draft:!1,unlisted:!1,editUrl:"https://github.com/tracywong117/tracy-sra-doc/tree/main/docs/data-processing/data-enrichment.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"3. Useful Data",permalink:"/tracy-sra-doc/docs/data-processing/useful-data"},next:{title:"5. Form the dataframe",permalink:"/tracy-sra-doc/docs/data-processing/form-the-dataframe"}},l={},a=[{value:"4.1 Extract and enrich region (country/ country: city) and geographical location (lat, lon) information",id:"41-extract-and-enrich-region-country-country-city-and-geographical-location-lat-lon-information",level:2},{value:"Analysis",id:"analysis",level:3},{value:"Infer region information",id:"infer-region-information",level:4},{value:"4.2 Extract and enrich organism == &#39;Metagenome&#39;",id:"42-extract-and-enrich-organism--metagenome",level:2},{value:"4.3 MeSH Terms Indexing",id:"43-mesh-terms-indexing",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"4-data-enrichment",children:"4. Data Enrichment"}),"\n",(0,s.jsx)(e.h2,{id:"41-extract-and-enrich-region-country-country-city-and-geographical-location-lat-lon-information",children:"4.1 Extract and enrich region (country/ country: city) and geographical location (lat, lon) information"}),"\n",(0,s.jsx)(e.h3,{id:"analysis",children:"Analysis"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:'country = row.get("geo_loc_name_sam", [""])[0] if row.get("geo_loc_name_sam") else row.get("geo_loc_name_country_calc", "")'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"geo_loc_name_country_calc"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"geo_loc_name_country_calc"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"count_entity"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"1"}),(0,s.jsx)(e.td,{children:"null"}),(0,s.jsx)(e.td,{children:"11149743"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"2"}),(0,s.jsx)(e.td,{children:"USA"}),(0,s.jsx)(e.td,{children:"6125770"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"3"}),(0,s.jsx)(e.td,{children:"United Kingdom"}),(0,s.jsx)(e.td,{children:"3108459"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"4"}),(0,s.jsx)(e.td,{children:"uncalculated"}),(0,s.jsx)(e.td,{children:"2067001"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"5"}),(0,s.jsx)(e.td,{children:"China"}),(0,s.jsx)(e.td,{children:"1438227"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"6"}),(0,s.jsx)(e.td,{children:"Canada"}),(0,s.jsx)(e.td,{children:"330030"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"7"}),(0,s.jsx)(e.td,{children:"Australia"}),(0,s.jsx)(e.td,{children:"275692"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"8"}),(0,s.jsx)(e.td,{children:"Germany"}),(0,s.jsx)(e.td,{children:"236836"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"9"}),(0,s.jsx)(e.td,{children:"Japan"}),(0,s.jsx)(e.td,{children:"233636"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"..."}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"geo_loc_name_sam"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"  SELECT DISTINCT ARRAY_LENGTH(geo_loc_name_sam) as length, count(*) AS count_entity\n  FROM `nih-sra-datastore.sra.metadata`\n  GROUP BY length\n  ORDER BY count_entity DESC;\n"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"length"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"count_entity"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"1"}),(0,s.jsx)(e.td,{children:"0"}),(0,s.jsx)(e.td,{children:"15469497"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"2"}),(0,s.jsx)(e.td,{children:"1"}),(0,s.jsx)(e.td,{children:"12663128"})]})]})]}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"geo_loc_name_sam"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"count_entity"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"1"}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{children:"15469497"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"2"}),(0,s.jsx)(e.td,{children:"missing"}),(0,s.jsx)(e.td,{children:"1272361"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"3"}),(0,s.jsx)(e.td,{children:"USA"}),(0,s.jsx)(e.td,{children:"748202"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"4"}),(0,s.jsx)(e.td,{children:"USA: California"}),(0,s.jsx)(e.td,{children:"610694"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"5"}),(0,s.jsx)(e.td,{children:"not applicable"}),(0,s.jsx)(e.td,{children:"326638"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"6"}),(0,s.jsx)(e.td,{children:"USA: Colorado"}),(0,s.jsx)(e.td,{children:"267877"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"7"}),(0,s.jsx)(e.td,{children:"USA: Massachusetts"}),(0,s.jsx)(e.td,{children:"199052"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"8"}),(0,s.jsx)(e.td,{children:"China"}),(0,s.jsx)(e.td,{children:"197794"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"9"}),(0,s.jsx)(e.td,{children:"USA: Texas"}),(0,s.jsx)(e.td,{children:"168851"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"..."}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"  SELECT COUNT(*) AS count_entity\n  FROM `nih-sra-datastore.sra.metadata`\n  WHERE (ARRAY_TO_STRING(geo_loc_name_sam, '') = '' or LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"na\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"not%\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"missing\")\n  ORDER BY count_entity DESC;\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"17294634\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"geo_loc_name_sam"})," has more detail on the region."]}),"\n",(0,s.jsx)(e.li,{children:"Total records: 28132625"}),"\n",(0,s.jsxs)(e.li,{children:["Number of records without ",(0,s.jsx)(e.code,{children:"geo_loc_name_sam"}),": 17294634"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Can use ",(0,s.jsx)(e.code,{children:"geo_loc_name_country_calc"})," to replace ",(0,s.jsx)(e.code,{children:"geo_loc_name_sam"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"  SELECT COUNT(*) AS count_entity\n  FROM `nih-sra-datastore.sra.metadata`\n  WHERE (ARRAY_TO_STRING(geo_loc_name_sam, '') = '' or LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"na\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"not%\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"missing\")\n  AND NOT(geo_loc_name_country_calc LIKE \"uncalculated\" or geo_loc_name_country_calc IS NULL)\n  ORDER BY count_entity DESC;\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"4236366\n"})}),"\n",(0,s.jsx)(e.p,{children:"Number of records need to be inferred 13058268"}),"\n",(0,s.jsx)(e.h4,{id:"infer-region-information",children:"Infer region information"}),"\n",(0,s.jsxs)(e.p,{children:["Link records to study_records by ",(0,s.jsx)(e.code,{children:"sra_study"})," and ",(0,s.jsx)(e.code,{children:"PRIMARY_ID"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"  SELECT DISTINCT sra_study, COUNT(*) AS count_entity\n  FROM `nih-sra-datastore.sra.metadata`\n  WHERE (ARRAY_TO_STRING(geo_loc_name_sam, '') = '' or LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"na\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"not%\" OR LOWER(ARRAY_TO_STRING(geo_loc_name_sam, '')) LIKE \"missing\")\n  AND (geo_loc_name_country_calc LIKE \"uncalculated\" or geo_loc_name_country_calc IS NULL)\n  GROUP BY sra_study\n  ORDER BY count_entity DESC;\n"})}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Row"}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"sra_study"})}),(0,s.jsx)(e.th,{children:(0,s.jsx)(e.strong,{children:"count_entity"})})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"1"}),(0,s.jsx)(e.td,{children:"ERP000190"}),(0,s.jsx)(e.td,{children:"145780"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"2"}),(0,s.jsx)(e.td,{children:"SRP131661"}),(0,s.jsx)(e.td,{children:"99868"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"3"}),(0,s.jsx)(e.td,{children:"ERP000195"}),(0,s.jsx)(e.td,{children:"98098"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"4"}),(0,s.jsx)(e.td,{children:"ERP013950"}),(0,s.jsx)(e.td,{children:"85608"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"5"}),(0,s.jsx)(e.td,{children:"SRP405951"}),(0,s.jsx)(e.td,{children:"75433"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"..."}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Number of rows: 265960"}),(0,s.jsx)(e.td,{}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsx)(e.p,{children:"Theoretically, number of records that region information can't be inferred: 20117 (records that do not have study record)"}),"\n",(0,s.jsx)(e.h2,{id:"42-extract-and-enrich-organism--metagenome",children:"4.2 Extract and enrich organism == 'Metagenome'"}),"\n",(0,s.jsx)(e.h2,{id:"43-mesh-terms-indexing",children:"4.3 MeSH Terms Indexing"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Categories"}),(0,s.jsx)(e.th,{children:"Tree number"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Anatomy"}),(0,s.jsx)(e.td,{children:"A"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Organisms"}),(0,s.jsx)(e.td,{children:"B"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Diseases"}),(0,s.jsx)(e.td,{children:"C"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Chemicals and Drugs"}),(0,s.jsx)(e.td,{children:"D"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Analytical, Diagnostic and Therapeutic Techniques, and Equipment"}),(0,s.jsx)(e.td,{children:"E"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Psychiatry and Psychology"}),(0,s.jsx)(e.td,{children:"F"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Phenomena and Processes"}),(0,s.jsx)(e.td,{children:"G"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Disciplines and Occupations"}),(0,s.jsx)(e.td,{children:"H"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Anthropology, Education, Sociology and Social Phenomena"}),(0,s.jsx)(e.td,{children:"I"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Technology, Industry, and Agriculture"}),(0,s.jsx)(e.td,{children:"J"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Humanities"}),(0,s.jsx)(e.td,{children:"K"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Information Sciecne"}),(0,s.jsx)(e.td,{children:"L"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Names Groups"}),(0,s.jsx)(e.td,{children:"M"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Health Care"}),(0,s.jsx)(e.td,{children:"N"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Publication Characteristics"}),(0,s.jsx)(e.td,{children:"V"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Geographicals"}),(0,s.jsx)(e.td,{children:"Z"})]})]})]})]})}function o(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>c,x:()=>i});var s=r(6540);const t={},d=s.createContext(t);function c(n){const e=s.useContext(d);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:c(n.components),s.createElement(d.Provider,{value:e},n.children)}}}]);